#!/usr/bin/env bash
set -euo pipefail

ROOT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
BUILD_DIR="${TMPDIR:-/tmp}/sprout-build-${USER:-user}"
BIN_PATH="${BUILD_DIR}/sprout-dev"

mkdir -p "$BUILD_DIR"
(
  cd "$ROOT_DIR"
  GOCACHE="${GOCACHE:-/tmp/gocache}" go build -o "$BIN_PATH" ./cmd/sprout
)

exec "$BIN_PATH" "$@"
